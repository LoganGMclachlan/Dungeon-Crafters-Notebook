import{u as Ce,r as d,j as n,d as ae,e as C,f as j,h as k,i as Ne,R as O,k as $,H as se,l as ke,L as ie,m as V,n as M,E as le,o as ce,p as De,q as Be,t as Oe,v as Le}from"./index-9187fbae.js";function Ae({game:e,setGame:t,details:r}){const o=Ce(),[s,a]=d.useState(e.title),[i,l]=d.useState(e.colour),[h,m]=d.useState(!1);d.useEffect(()=>{g()},[]);const g=()=>{const f=localStorage.getItem("SAVED_GAMES");if(f===null)return;JSON.parse(f).map(c=>{c.game.id===e.id&&m(!0)})},u=()=>{let f=[];const E=localStorage.getItem("SAVED_GAMES");E!==null&&(f=JSON.parse(E)),f.push({game:e,blocks:r[0],folders:r[1],links:r[2],boards:r[3],placements:r[4]}),localStorage.setItem("SAVED_GAMES",JSON.stringify(f)),m(!0),alert(`Downloaded ${e.title}`)},v=()=>{if(!window.confirm("Remove this game from downloads?"))return;const f=localStorage.getItem("SAVED_GAMES");let E=JSON.parse(f);E=E.filter(c=>c.game.id!==e.id),localStorage.setItem("SAVED_GAMES",JSON.stringify(E)),m(!1)},S=async f=>{if(f.preventDefault(),s===""){alert("Please enter a title");return}t({...e,title:s,colour:i});try{await ae(C(j,"Games",e.id),{title:s,colour:i})}catch(E){console.error(E)}},y=async()=>{if(window.confirm("Are you sure you want to delete this game?"))try{r.map((f,E)=>{switch(console.log(f),E){case 0:f.map(async c=>{await k(C(j,"Blocks",c.id)),console.log("Deleted block: "+c.title)});break;case 1:f.map(async c=>{await k(C(j,"Folders",c.id)),console.log("Deleted folder: "+c.title)});break;case 2:f.map(async c=>{await k(C(j,"Links",c.id)),console.log("Deleted link: "+c.id)});break;case 3:f.map(async c=>{await k(C(j,"Boards",c.id)),console.log("Deleted board: "+c.title)});break;case 4:f.map(async c=>{await k(C(j,"Placements",c.id)),console.log("Deleted placement: "+c.id)});break}}),await k(C(j,"Games",e.id)),console.log("Delete game: "+e.title),o("/")}catch(f){alert("there was a problem deleting this game try again later."),console.error(f)}},N=()=>{localStorage.setItem("SELECTED_BLOCKS",JSON.stringify(null)),localStorage.setItem("SELECTED_BOARD",JSON.stringify(null)),o("/")};return n.jsx("div",{className:"menu",children:n.jsxs("div",{className:"container details",children:[n.jsx("h1",{children:"Game Details"}),n.jsxs("form",{onSubmit:f=>S(f),children:[n.jsx("input",{value:s,onChange:f=>a(f.target.value),className:"form-input",placeholder:"Enter a title..."}),n.jsx("br",{}),n.jsxs("select",{onChange:f=>l(f.target.value),className:"form-input",value:i,children:[n.jsx("option",{disabled:!0,children:"Select a Colour"}),n.jsx("option",{value:"red",children:"Red"}),n.jsx("option",{value:"yellow",children:"Yellow"}),n.jsx("option",{value:"greenyellow",children:"Green"}),n.jsx("option",{value:"lightskyblue",children:"Blue"}),n.jsx("option",{value:"grey",children:"Grey"}),n.jsx("option",{value:"rgb(155, 3, 155)",children:"Purple"})]}),n.jsx("br",{}),n.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",justifyContent:"center"},children:[n.jsx("button",{type:"submit",className:"form-btn",children:"Save Details"}),n.jsx("button",{className:"form-btn",onClick:()=>N(),children:"Exit Game"}),n.jsx("button",{className:"form-btn red",onClick:()=>y(),children:"Delete Game"}),h?n.jsx("button",{className:"form-btn",onClick:()=>v(),children:"Downloaded"}):n.jsx("button",{className:"form-btn",onClick:()=>u(),children:"Download Game"}),n.jsx("small",{children:"Download feature not yet fully functional."})]})]})]})})}function Te({blocks:e,select:t}){return n.jsx("ul",{className:"block-snippets",children:e.map(r=>n.jsx("li",{onClick:()=>t(r),children:n.jsx("p",{children:r.title})},r.id))})}var de={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var o=[],s=0;s<arguments.length;s++){var a=arguments[s];if(a){var i=typeof a;if(i==="string"||i==="number")o.push(a);else if(Array.isArray(a)){if(a.length){var l=r.apply(null,a);l&&o.push(l)}}else if(i==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){o.push(a.toString());continue}for(var h in a)t.call(a,h)&&a[h]&&o.push(h)}}}return o.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(de);var Re=de.exports;const _=Ne(Re);function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Y.apply(this,arguments)}function ue(e,t){if(e==null)return{};var r={},o=Object.keys(e),s,a;for(a=0;a<o.length;a++)s=o[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function te(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function _e(e){var t=Ie(e,"string");return typeof t=="symbol"?t:String(t)}function Ie(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Me(e,t,r){var o=d.useRef(e!==void 0),s=d.useState(t),a=s[0],i=s[1],l=e!==void 0,h=o.current;return o.current=l,!l&&h&&a!==t&&i(t),[l?e:a,d.useCallback(function(m){for(var g=arguments.length,u=new Array(g>1?g-1:0),v=1;v<g;v++)u[v-1]=arguments[v];r&&r.apply(void 0,[m].concat(u)),i(m)},[r])]}function Pe(e,t){return Object.keys(t).reduce(function(r,o){var s,a=r,i=a[te(o)],l=a[o],h=ue(a,[te(o),o].map(_e)),m=t[o],g=Me(l,i,e[m]),u=g[0],v=g[1];return Y({},h,(s={},s[o]=u,s[m]=v,s))},e)}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,s){return o.__proto__=s,o},q(e,t)}function Fe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,q(e,t)}const Ge=["xxl","xl","lg","md","sm","xs"],$e="xs",Ue=d.createContext({prefixes:{},breakpoints:Ge,minBreakpoint:$e});function P(e,t){const{prefixes:r}=d.useContext(Ue);return e||r[t]||t}function Ve(e){return e&&e.ownerDocument||document}function Je(e){var t=Ve(e);return t&&t.defaultView||window}function He(e,t){return Je(e).getComputedStyle(e,t)}var Ke=/([A-Z])/g;function Xe(e){return e.replace(Ke,"-$1").toLowerCase()}var We=/^ms-/;function J(e){return Xe(e).replace(We,"-ms-")}var ze=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Ye(e){return!!(e&&ze.test(e))}function K(e,t){var r="",o="";if(typeof t=="string")return e.style.getPropertyValue(J(t))||He(e).getPropertyValue(J(t));Object.keys(t).forEach(function(s){var a=t[s];!a&&a!==0?e.style.removeProperty(J(s)):Ye(s)?o+=s+"("+a+") ":r+=J(s)+": "+a+";"}),o&&(r+="transform: "+o+";"),e.style.cssText+=";"+r}const ne={disabled:!1},fe=O.createContext(null);var qe=function(t){return t.scrollTop},U="unmounted",A="exited",T="entering",R="entered",X="exiting",L=function(e){Fe(t,e);function t(o,s){var a;a=e.call(this,o,s)||this;var i=s,l=i&&!i.isMounting?o.enter:o.appear,h;return a.appearStatus=null,o.in?l?(h=A,a.appearStatus=T):h=R:o.unmountOnExit||o.mountOnEnter?h=U:h=A,a.state={status:h},a.nextCallback=null,a}t.getDerivedStateFromProps=function(s,a){var i=s.in;return i&&a.status===U?{status:A}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(s){var a=null;if(s!==this.props){var i=this.state.status;this.props.in?i!==T&&i!==R&&(a=T):(i===T||i===R)&&(a=X)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var s=this.props.timeout,a,i,l;return a=i=l=s,s!=null&&typeof s!="number"&&(a=s.exit,i=s.enter,l=s.appear!==void 0?s.appear:i),{exit:a,enter:i,appear:l}},r.updateStatus=function(s,a){if(s===void 0&&(s=!1),a!==null)if(this.cancelNextCallback(),a===T){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:$.findDOMNode(this);i&&qe(i)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===A&&this.setState({status:U})},r.performEnter=function(s){var a=this,i=this.props.enter,l=this.context?this.context.isMounting:s,h=this.props.nodeRef?[l]:[$.findDOMNode(this),l],m=h[0],g=h[1],u=this.getTimeouts(),v=l?u.appear:u.enter;if(!s&&!i||ne.disabled){this.safeSetState({status:R},function(){a.props.onEntered(m)});return}this.props.onEnter(m,g),this.safeSetState({status:T},function(){a.props.onEntering(m,g),a.onTransitionEnd(v,function(){a.safeSetState({status:R},function(){a.props.onEntered(m,g)})})})},r.performExit=function(){var s=this,a=this.props.exit,i=this.getTimeouts(),l=this.props.nodeRef?void 0:$.findDOMNode(this);if(!a||ne.disabled){this.safeSetState({status:A},function(){s.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:X},function(){s.props.onExiting(l),s.onTransitionEnd(i.exit,function(){s.safeSetState({status:A},function(){s.props.onExited(l)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(s,a){a=this.setNextCallback(a),this.setState(s,a)},r.setNextCallback=function(s){var a=this,i=!0;return this.nextCallback=function(l){i&&(i=!1,a.nextCallback=null,s(l))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},r.onTransitionEnd=function(s,a){this.setNextCallback(a);var i=this.props.nodeRef?this.props.nodeRef.current:$.findDOMNode(this),l=s==null&&!this.props.addEndListener;if(!i||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var h=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],m=h[0],g=h[1];this.props.addEndListener(m,g)}s!=null&&setTimeout(this.nextCallback,s)},r.render=function(){var s=this.state.status;if(s===U)return null;var a=this.props,i=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var l=ue(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return O.createElement(fe.Provider,{value:null},typeof i=="function"?i(s,l):O.cloneElement(O.Children.only(i),l))},t}(O.Component);L.contextType=fe;L.propTypes={};function I(){}L.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:I,onEntering:I,onEntered:I,onExit:I,onExiting:I,onExited:I};L.UNMOUNTED=U;L.EXITED=A;L.ENTERING=T;L.ENTERED=R;L.EXITING=X;const Ze=L,Qe=!!(typeof window<"u"&&window.document&&window.document.createElement);var Z=!1,Q=!1;try{var z={get passive(){return Z=!0},get once(){return Q=Z=!0}};Qe&&(window.addEventListener("test",z,z),window.removeEventListener("test",z,!0))}catch{}function et(e,t,r,o){if(o&&typeof o!="boolean"&&!Q){var s=o.once,a=o.capture,i=r;!Q&&s&&(i=r.__once||function l(h){this.removeEventListener(t,l,a),r.call(this,h)},r.__once=i),e.addEventListener(t,i,Z?o:a)}e.addEventListener(t,r,o)}function tt(e,t,r,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(t,r,s),r.__once&&e.removeEventListener(t,r.__once,s)}function he(e,t,r,o){return et(e,t,r,o),function(){tt(e,t,r,o)}}function nt(e,t,r,o){if(r===void 0&&(r=!1),o===void 0&&(o=!0),e){var s=document.createEvent("HTMLEvents");s.initEvent(t,r,o),e.dispatchEvent(s)}}function rt(e){var t=K(e,"transitionDuration")||"",r=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*r}function ot(e,t,r){r===void 0&&(r=5);var o=!1,s=setTimeout(function(){o||nt(e,"transitionend",!0)},t+r),a=he(e,"transitionend",function(){o=!0},{once:!0});return function(){clearTimeout(s),a()}}function at(e,t,r,o){r==null&&(r=rt(e)||0);var s=ot(e,r,o),a=he(e,"transitionend",t);return function(){s(),a()}}function re(e,t){const r=K(e,t)||"",o=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*o}function st(e,t){const r=re(e,"transitionDuration"),o=re(e,"transitionDelay"),s=at(e,a=>{a.target===e&&(s(),t(a))},r+o)}function G(...e){return e.filter(t=>t!=null).reduce((t,r)=>{if(typeof r!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return t===null?r:function(...s){t.apply(this,s),r.apply(this,s)}},null)}function it(e){e.offsetHeight}const oe=e=>!e||typeof e=="function"?e:t=>{e.current=t};function lt(e,t){const r=oe(e),o=oe(t);return s=>{r&&r(s),o&&o(s)}}function ct(e,t){return d.useMemo(()=>lt(e,t),[e,t])}function dt(e){return e&&"setState"in e?$.findDOMNode(e):e??null}const ut=O.forwardRef(({onEnter:e,onEntering:t,onEntered:r,onExit:o,onExiting:s,onExited:a,addEndListener:i,children:l,childRef:h,...m},g)=>{const u=d.useRef(null),v=ct(u,h),S=p=>{v(dt(p))},y=p=>w=>{p&&u.current&&p(u.current,w)},N=d.useCallback(y(e),[e]),f=d.useCallback(y(t),[t]),E=d.useCallback(y(r),[r]),c=d.useCallback(y(o),[o]),x=d.useCallback(y(s),[s]),b=d.useCallback(y(a),[a]),B=d.useCallback(y(i),[i]);return n.jsx(Ze,{ref:g,...m,onEnter:N,onEntered:E,onEntering:f,onExit:c,onExited:b,onExiting:x,addEndListener:B,nodeRef:u,children:typeof l=="function"?(p,w)=>l(p,{...w,ref:S}):O.cloneElement(l,{ref:S})})}),ft=ut,ht={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function pt(e,t){const r=`offset${e[0].toUpperCase()}${e.slice(1)}`,o=t[r],s=ht[e];return o+parseInt(K(t,s[0]),10)+parseInt(K(t,s[1]),10)}const mt={[A]:"collapse",[X]:"collapsing",[T]:"collapsing",[R]:"collapse show"},xt=O.forwardRef(({onEnter:e,onEntering:t,onEntered:r,onExit:o,onExiting:s,className:a,children:i,dimension:l="height",in:h=!1,timeout:m=300,mountOnEnter:g=!1,unmountOnExit:u=!1,appear:v=!1,getDimensionValue:S=pt,...y},N)=>{const f=typeof l=="function"?l():l,E=d.useMemo(()=>G(p=>{p.style[f]="0"},e),[f,e]),c=d.useMemo(()=>G(p=>{const w=`scroll${f[0].toUpperCase()}${f.slice(1)}`;p.style[f]=`${p[w]}px`},t),[f,t]),x=d.useMemo(()=>G(p=>{p.style[f]=null},r),[f,r]),b=d.useMemo(()=>G(p=>{p.style[f]=`${S(f,p)}px`,it(p)},o),[o,S,f]),B=d.useMemo(()=>G(p=>{p.style[f]=null},s),[f,s]);return n.jsx(ft,{ref:N,addEndListener:st,...y,"aria-expanded":y.role?h:null,onEnter:E,onEntering:c,onEntered:x,onExit:b,onExiting:B,childRef:i.ref,in:h,timeout:m,mountOnEnter:g,unmountOnExit:u,appear:v,children:(p,w)=>O.cloneElement(i,{...w,className:_(a,i.props.className,mt[p],f==="width"&&"collapse-horizontal")})})}),vt=xt;function pe(e,t){return Array.isArray(e)?e.includes(t):e===t}const me=d.createContext({});me.displayName="AccordionContext";const W=me,xe=d.forwardRef(({as:e="div",bsPrefix:t,className:r,children:o,eventKey:s,...a},i)=>{const{activeEventKey:l}=d.useContext(W);return t=P(t,"accordion-collapse"),n.jsx(vt,{ref:i,in:pe(l,s),...a,className:_(r,t),children:n.jsx(e,{children:d.Children.only(o)})})});xe.displayName="AccordionCollapse";const ve=xe,ge=d.createContext({eventKey:""});ge.displayName="AccordionItemContext";const ee=ge,ye=d.forwardRef(({as:e="div",bsPrefix:t,className:r,onEnter:o,onEntering:s,onEntered:a,onExit:i,onExiting:l,onExited:h,...m},g)=>{t=P(t,"accordion-body");const{eventKey:u}=d.useContext(ee);return n.jsx(ve,{eventKey:u,onEnter:o,onEntering:s,onEntered:a,onExit:i,onExiting:l,onExited:h,children:n.jsx(e,{ref:g,...m,className:_(r,t)})})});ye.displayName="AccordionBody";const gt=ye;function yt(e,t){const{activeEventKey:r,onSelect:o,alwaysOpen:s}=d.useContext(W);return a=>{let i=e===r?null:e;s&&(Array.isArray(r)?r.includes(e)?i=r.filter(l=>l!==e):i=[...r,e]:i=[e]),o==null||o(i,a),t==null||t(a)}}const Ee=d.forwardRef(({as:e="button",bsPrefix:t,className:r,onClick:o,...s},a)=>{t=P(t,"accordion-button");const{eventKey:i}=d.useContext(ee),l=yt(i,o),{activeEventKey:h}=d.useContext(W);return e==="button"&&(s.type="button"),n.jsx(e,{ref:a,onClick:l,...s,"aria-expanded":Array.isArray(h)?h.includes(i):i===h,className:_(r,t,!pe(h,i)&&"collapsed")})});Ee.displayName="AccordionButton";const we=Ee,je=d.forwardRef(({as:e="h2",bsPrefix:t,className:r,children:o,onClick:s,...a},i)=>(t=P(t,"accordion-header"),n.jsx(e,{ref:i,...a,className:_(r,t),children:n.jsx(we,{onClick:s,children:o})})));je.displayName="AccordionHeader";const Et=je,be=d.forwardRef(({as:e="div",bsPrefix:t,className:r,eventKey:o,...s},a)=>{t=P(t,"accordion-item");const i=d.useMemo(()=>({eventKey:o}),[o]);return n.jsx(ee.Provider,{value:i,children:n.jsx(e,{ref:a,...s,className:_(r,t)})})});be.displayName="AccordionItem";const wt=be,Se=d.forwardRef((e,t)=>{const{as:r="div",activeKey:o,bsPrefix:s,className:a,onSelect:i,flush:l,alwaysOpen:h,...m}=Pe(e,{activeKey:"onSelect"}),g=P(s,"accordion"),u=d.useMemo(()=>({activeEventKey:o,onSelect:i,alwaysOpen:h}),[o,i,h]);return n.jsx(W.Provider,{value:u,children:n.jsx(r,{ref:t,...m,className:_(a,g,l&&`${g}-flush`)})})});Se.displayName="Accordion";const H=Object.assign(Se,{Button:we,Collapse:ve,Item:wt,Header:Et,Body:gt});function jt({folders:e,blocks:t,select:r,newBlock:o,setFolders:s,gameId:a}){async function i(l){if(!navigator.onLine){alert("Cannot delete folders while offline");return}if(!window.confirm("Are you sure want to delete this folder & its blocks?"))return;const h=t.filter(m=>m.folderid===l.id);try{h.map(async m=>{await k(C(j,"Blocks",m.id))}),await k(C(j,"Folders",l.id)),s(e.filter(m=>m.id!==l.id))}catch(m){console.error(m),alert("Failed to delete this folder, try again later.")}}return n.jsx(H,{className:"accordion-container",children:e.map(l=>n.jsxs(H.Item,{eventKey:l.id,style:{border:"1px solid grey"},children:[n.jsx(H.Header,{children:l.title}),n.jsxs(H.Body,{style:{paddingTop:"20px",paddingLeft:"8px",paddingRight:"8px"},children:[n.jsx(Te,{blocks:t.filter(h=>h.folderid===l.id),select:r}),n.jsxs("span",{className:"folder-btn",children:[n.jsx("button",{onClick:()=>o(l.id),children:"New Block"}),n.jsx("button",{style:{backgroundColor:"red"},onClick:()=>i(l),children:"Delete Folder"})]})]})]},l.id))})}const bt=`
<h2>Creature name</h2>
<small>Medium Humanoid (Elf), Neutral</small>
<hr/>
<p>
    Armour Class: 10<br/>
    Hip Points: 10<br/>
    Speed: 30ft
</p>
<hr/>
<table>
    <tr>
        <th>STR</th>
        <th>DEX</th>
        <th>CON</th>
        <th>INT</th>
        <th>WIS</th>
        <th>CHA</th>
    </tr>
    <tr>
        <td>+0</td>
        <td>+0</td>
        <td>+0</td>
        <td>+0</td>
        <td>+0</td>
        <td>+0</td>
    </tr>
</table>
<hr/>
<p>
    Saving Throws: STR +2, DEX +2<br/>
    Skills: Athletics +2, History +2<br/>
    Senses: darkvision 60 ft, passive Perception 11<br/>
    Languages: common, other<br/>
    Proficiency Bonus: +2
</p>
<hr/>
<h3>Actions</h3>
<p>
    Dagger. Melee or Ranged Weapon Attack: +2 to hit, reach 5 ft 
    or range 20/60 ft, one target. Hit: 2 (1d4) piercing damage.
</p>
<hr/>
<h3>Features</h3>
<p>
    Fey Ancestry. Has advantage on saving throws against 
    being charmed, and can't be put to sleep by magic.
</p>
`,St=`
<h2>Encounter Title</h2>
<small>Difficulty Estimate: </small>
<hr/>
<h3>Description</h3>
<p></p>
<hr/>
<h3>Active Creatures</h3>
<table>
    <tr>
        <th>Creature Name</th>
        <th>Number of Creatures</th>
        <th>Unique modifier</th>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
    </tr>
</table>
`;function Ct({content:e,close:t}){return n.jsxs("li",{children:[n.jsx("label",{children:"Use Template: "}),n.jsxs("select",{className:"option-select",defaultValue:"defualt",onChange:r=>{e[1](e[0]+r.target.value),t()},children:[n.jsx("option",{value:"defualt",disabled:!0,children:"None"}),n.jsx("option",{value:bt,children:"Stat Block"}),n.jsx("option",{value:St,children:"Encounter Plan"})]})]})}function Nt({colour:e,gameId:t,data:r,blocks:o,links:s,closeBlock:a,blockLinks:i,block:l,placements:h,boards:m,content:g}){const[u,v]=d.useState(!1),S=async c=>{if(c.preventDefault(),v(!1),!navigator.onLine){alert("Cannot save blocks while offline");return}try{let x=l;x.title=r[0],x.content=r[1],l.new?(delete x.new,await V(M(j,"Blocks"),x).then(b=>{x.id=b.id,o[1]([...o[0],x])})):(await ae(C(j,"Blocks",l.id),{title:r[0],content:r[1]}),o[1](o[0].map(b=>b.id===x.id?x:b))),alert("Block saved successfuly!")}catch(x){console.error(x),alert("Failed to save this block, try again later.")}},y=async()=>{if(!navigator.onLine){alert("Cannot delete blocks while offline");return}if(window.confirm("Are you sure you want to delete this block?"))try{await k(C(j,"Blocks",l.id)),o[1](o[0].filter(x=>x.id!=l.id));let c=[...s[0]];i.map(async x=>{await k(C(j,"Links",x.linkId)).then(c=c.filter(b=>b.id!==x.linkId))}),s[1](c),h.map(async x=>{x.blockid===l.id&&await k(C(j,"Placements",x.id))}),h[1]([...h[0].filter(x=>x.blockid!==l.id)]),a()}catch(c){console.error(c),alert("Something went wrong, try again later.")}},N=async c=>{if(!navigator.onLine){alert("Cannot link blocks while offline");return}if(c===l.id){alert("Cannot link a block to itself");return}let x=!1;if(i.map(b=>{b.id===c&&(x=!0)}),x){alert("Selected block is already linked to this one");return}try{let b={block1:l.id,block2:c,gameid:t};await V(M(j,"Links"),b).then(B=>{b.id=B.id,s[1]([...s[0],b])})}catch(b){console.error(b),alert("Something went wrong, try again later.")}},f=async c=>{if(!navigator.onLine){alert("Cannot add to boards while offline");return}try{let x={blockid:l.id,boardid:c,gameid:t};await V(M(j,"Placements"),x).then(b=>{x.id=b.id}),h[1]([...h[0],x]),alert("Block added to selected board.")}catch(x){console.error(x),alert("Something went wrong, try again later.")}},E=()=>v(!1);return n.jsxs("div",{style:{display:"inline"},children:[n.jsx("button",{className:"options-btn",onClick:()=>v(!u),style:{backgroundColor:`${e}`},children:"Options"}),n.jsx(se,{message:ke}),u&&n.jsxs("ul",{className:"options-collapse",children:[n.jsx("li",{onClick:E,children:"Close Options"}),n.jsx("li",{onClick:c=>S(c),children:"Save"}),n.jsx(Ct,{content:g,close:E}),!l.new&&n.jsxs(n.Fragment,{children:[n.jsxs("li",{children:[n.jsx("label",{children:"Link to: "}),n.jsxs("select",{className:"option-select",defaultValue:"defualt",onChange:c=>{N(c.target.value),E()},children:[n.jsx("option",{value:"defualt",disabled:!0,children:"Select Block"}),o[0].map(c=>n.jsx("option",{value:c.id,children:c.title},c.id))]})]}),n.jsxs("li",{children:[n.jsx("label",{children:"Add to Board: "}),n.jsxs("select",{className:"option-select",defaultValue:"defualt",onChange:c=>{f(c.target.value),E()},children:[n.jsx("option",{value:"defualt",disabled:!0,children:"Select Board"}),m.map(c=>n.jsx("option",{value:c.id,children:c.title},c.id))]})]}),n.jsx("li",{children:n.jsx(ie,{to:"../share/"+l.id,target:"_blank",children:"Share"})}),n.jsx("li",{onClick:y,style:{color:"red"},children:"Delete"})]})]})]})}function kt({content:e,setContent:t}){return n.jsx(le,{apiKey:"c70a4j85ev1e4q1dopyxbpw772r0lz047pef9umlig63xfdh",value:e,onEditorChange:(r,o)=>t(o.getContent()),init:{height:360,menubar:!1,browser_spellcheck:!0,resize:!1,plugins:"table | lists",toolbar:"undo redo | blocks | bold italic forecolor | bullist numlist outdent indent | table tabledelete | tableprops tablerowprops tablecellprops | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"}})}function Dt({block:e,setBlocks:t,close:r,blocks:o,colour:s,gameId:a,links:i,setLinks:l,select:h,setPlacements:m,boards:g,placements:u}){const[v,S]=d.useState(""),[y,N]=d.useState(""),[f,E]=d.useState([]);d.useEffect(()=>{S(e.title),N(e.content),E(c())},[e]),d.useEffect(()=>{E(c())},[i]),d.useEffect(()=>{let p=JSON.parse(localStorage.getItem("SELECTED_BLOCKS"));if(!(p===null||p.length<1)){for(let w=0;w<p.length;w++)if(p[w].id===e.id){p[w].title=v,p[w].content=y,localStorage.setItem("SELECTED_BLOCKS",JSON.stringify(p));return}}},[v,y]);const c=()=>{let p=[];return i.map(w=>{if(w.block1===e.id){let D=o.filter(F=>F.id===w.block2)[0];D.linkId=w.id,p.push(D)}else if(w.block2===e.id){let D=o.filter(F=>F.id===w.block1)[0];D.linkId=w.id,p.push(D)}}),p},x=()=>{y!==e.content&&!window.confirm("Unsaved changes detected, are you sure you want to continue?")||r()},b=async(p,w)=>{if(!navigator.onLine){alert("Cannot delete links while offline");return}if(window.confirm(`Are you sure you want to delete the link to "${w}"?`))try{await k(C(j,"Links",p));let D=[...i].filter(F=>F.id!==p);l(D),B(D)}catch(D){console.error(D),alert("Something went wrong, try again later.")}},B=p=>{let w=JSON.parse(localStorage.getItem("SAVED_GAMES"));w!==null&&(w.map(D=>(D.game.id===a&&(D.links=p),D)),localStorage.setItem("SAVED_GAMES",JSON.stringify(w)))};return n.jsxs("div",{className:"block",children:[n.jsx(Nt,{colour:s,gameId:a,data:[v,y],content:[y,N],blocks:[o,t],boards:g,links:[i,l],closeBlock:r,blockLinks:f,block:e,placements:[u,m]}),n.jsx("button",{className:"x-btn",onClick:x,children:"X"}),n.jsx("input",{value:v,className:"block-title",onChange:p=>S(p.target.value)}),n.jsx("br",{}),navigator.onLine?n.jsx(kt,{content:y,setContent:N}):n.jsx("textarea",{value:ce(y,{wordwrap:80}),className:"block-content"}),n.jsx("p",{className:"related-blocks",children:f.map(p=>n.jsxs("span",{children:[n.jsx("span",{onClick:()=>h(p),children:p.title}),n.jsx("label",{onClick:()=>b(p.linkId,p.title),children:"X"})]},p.id))})]})}function Bt({setFolders:e,folders:t,gameId:r}){const[o,s]=d.useState("");async function a(i){if(i.preventDefault(),!navigator.onLine){alert("Cannot create folders while offline");return}if(o===""){alert("Enter a title for your new folder first.");return}if(o.length>25){alert("Folder titles cannot be longer than 25 digits long.");return}try{await V(M(j,"Folders"),{title:o,gameid:r}).then(l=>{e([...t,{id:l.id,title:o,gameid:r}])}),s("")}catch(l){console.error(l),alert("Something went wrong and we coudlnt create your folder, please try again later")}}return n.jsxs("form",{onSubmit:i=>a(i),children:[n.jsx("input",{placeholder:"Folder title...",className:"form-input",style:{width:"85%",marginBottom:"-5px"},value:o,onChange:i=>s(i.target.value),style:{width:"70%",marginBottom:"0px"}}),n.jsx(se,{message:De}),n.jsx("button",{className:"form-btn",style:{width:"85%",padding:"5px"},type:"submit",children:"New Folder"})]})}function Ot({select:e,blocks:t}){const[r,o]=d.useState([]);function s(a){if(a===""){o([]);return}o(t.filter(i=>i.title.toLowerCase().includes(a.toLowerCase())))}return n.jsxs(n.Fragment,{children:[n.jsx("input",{placeholder:"Search...",className:"search-bar",onChange:a=>s(a.target.value),onClick:a=>s(a.target.value)}),n.jsx("ul",{className:"search-results",children:r.map(a=>n.jsx("li",{onClick:()=>{e(a),s("")},children:a.title}))})]})}function Lt({blocks:e,gameId:t,setBlocks:r,folders:o,setFolders:s,colour:a,links:i,setLinks:l,setPlacements:h,boards:m,placements:g}){const[u,v]=d.useState(()=>{const f=localStorage.getItem("SELECTED_BLOCKS");return JSON.parse(f)===null?[]:JSON.parse(f)});d.useEffect(()=>{localStorage.setItem("SELECTED_BLOCKS",JSON.stringify(u))},[u]);const S=f=>{y({title:"New Block",content:"",gameid:t,folderid:f,new:!0})},y=f=>{u.includes(f)||v([...u,f])},N=f=>v([...u].filter(E=>E.id!==f));return n.jsxs("div",{style:{display:"flex"},className:"blocks-container",children:[n.jsxs("div",{className:"folderList",children:[n.jsx(Ot,{select:y,blocks:e}),o.length>0&&n.jsx(jt,{folders:o,blocks:e,select:y,newBlock:S,setFolders:s,gameId:t}),n.jsx(Bt,{setFolders:s,folders:o,gameId:t})]}),n.jsx("div",{className:"block-list",children:u.map(f=>n.jsx(Dt,{block:f,blocks:e,colour:a,gameId:t,setLinks:l,setBlocks:r,close:()=>N(f.id),links:i,select:y,setPlacements:h,boards:m,placements:g},f.id))})]})}const At="/assets/YlWC-82c90721.gif";function Tt(){const[e,t]=d.useState(null),[r,o]=d.useState(20),s=()=>{t(Math.floor(Math.random()*r)+1);var a=document.getElementById("result");a.style.fontSize="1.4em",setTimeout(()=>a.style.fontSize="1.3em",200)};return n.jsxs("span",{style:{marginTop:"10px",marginLeft:"auto"},children:[n.jsxs("select",{style:{padding:"3px"},onChange:a=>{o(a.target.value),s()},children:[n.jsx("option",{value:20,default:!0,children:"d20"}),n.jsx("option",{value:12,children:"d12"}),n.jsx("option",{value:10,children:"d10"}),n.jsx("option",{value:8,children:"d8"}),n.jsx("option",{value:6,children:"d6"}),n.jsx("option",{value:4,children:"d4"}),n.jsx("option",{value:100,children:"d100"})]}),n.jsx("button",{onClick:s,style:{border:"none",padding:"2px"},children:"Roll!"}),n.jsx("div",{className:"roll-result",children:e&&n.jsx("div",{id:"result",children:e})})]})}function Rt({selected:e,setSelected:t,game:r}){return n.jsxs("div",{className:"nav-bar",style:{backgroundColor:`${r.colour}`},children:[n.jsx("h1",{className:"nav-title",children:r.title}),r.title==="Loading"&&n.jsx("img",{src:At,className:"loading-icon"}),e==="blocks"?n.jsx("button",{className:"nav-item",style:{textDecoration:"underline"},children:"Blocks"}):n.jsx("button",{className:"nav-item",onClick:()=>t("blocks"),children:"Blocks"}),e==="boards"?n.jsx("button",{className:"nav-item",style:{textDecoration:"underline"},children:"Boards"}):n.jsx("button",{className:"nav-item",onClick:()=>t("boards"),children:"Boards"}),e==="details"?n.jsx("button",{className:"nav-item",style:{textDecoration:"underline"},children:"Details"}):n.jsx("button",{className:"nav-item",onClick:()=>t("details"),children:"Details"}),n.jsx(Tt,{})]})}function _t({blocks:e,setPlacements:t,placements:r}){const[o,s]=d.useState([]);d.useEffect(()=>{s(e.sort((i,l)=>l.content.length-i.content.length))},[e]);const a=async i=>{if(window.confirm(`Are you sure you want to delete "${i.title}" from this board?`))try{await k(C(j,"Placements",i.placement)),t([...r].filter(l=>l.id!==i.placement))}catch(l){console.log(l),alert("something went wrong, try again later")}};return n.jsx("div",{className:"board-blocks",children:o.map(i=>n.jsxs("div",{children:[n.jsx("button",{className:"x-btn",onClick:()=>a(i),children:"X"}),n.jsx("h2",{children:i.title}),n.jsx("span",{children:navigator.onLine?n.jsx(le,{apiKey:"c70a4j85ev1e4q1dopyxbpw772r0lz047pef9umlig63xfdh",value:i.content,disabled:!0,inline:!0,init:{menubar:!1,toolbar:!1,resize:!1}}):n.jsx("textarea",{value:ce(i.content,{wordwrap:80})})})]},i.id))})}function It({boards:e,select:t,gameId:r,setBoards:o,placements:s,setPlacements:a,selected:i}){const[l,h]=d.useState(""),m=async()=>{if(!navigator.onLine){alert("Cannot create board while offline");return}try{let u={title:l,gameid:r};await V(M(j,"Boards"),u).then(v=>u.id=v.id),o([...e,u]),t(u.id),h(""),alert("New Board Created!")}catch(u){console.log(u),alert("Something went wrong, try again later.")}},g=async()=>{if(!i){alert("Select a board to delete.");return}if(!navigator.onLine){alert("Cannot delete boards while offline");return}if(window.confirm("Are you sure you want to delete this board?"))try{s.map(async u=>{u.boardid===i&&await k(C(j,"Placements",u.id))}),a([...s].filter(u=>u.boardid!==i)),await k(C(j,"Boards",i)),t(null)}catch(u){console.log(u),alert("Something went wrong, try again later.")}};return n.jsxs("div",{className:"board-control",children:[n.jsxs("div",{children:[n.jsxs("select",{defaultValue:"default",className:"form-input",style:{padding:"6px"},onChange:u=>t(u.target.value),children:[n.jsx("option",{value:"default",disabled:!0,children:"Select a Board"}),e.map(u=>n.jsx("option",{value:u.id,children:u.title},u.id))]}),n.jsx("br",{}),n.jsx("button",{className:"form-btn",style:{backgroundColor:"red"},onClick:()=>g(),children:"Delete Board"})]}),n.jsxs("div",{children:[n.jsx("input",{placeholder:"Board Title...",className:"form-input",value:l,onChange:u=>h(u.target.value)}),n.jsx("br",{}),n.jsx("button",{className:"form-btn",onClick:()=>m(),children:"Create Board"})]})]})}function Mt({boards:e,placements:t,blocks:r,gameId:o,setBoards:s,setPlacements:a}){const[i,l]=d.useState(()=>{const u=localStorage.getItem("SELECTED_BOARD");return JSON.parse(u)}),[h,m]=d.useState([]);d.useEffect(()=>{localStorage.setItem("SELECTED_BOARD",JSON.stringify(i))},[i]),d.useEffect(()=>{let u=[];t.filter(v=>v.boardid===i).map(v=>{let S=r.find(y=>y.id===v.blockid);S.placement=v.id,u.push(S)}),m(u)},[i,t]);const g=u=>u==null?"":e.filter(v=>v.id==u)[0].title;return n.jsxs("div",{className:"boards-container",children:[n.jsx("h1",{style:{fontWeight:"bold"},children:g(i)}),n.jsx(_t,{blocks:h,setPlacements:a,placements:t,gameId:o}),n.jsx(It,{boards:e,select:l,gameId:o,setBoards:s,placements:t,setPlacements:a,selected:i}),n.jsx("p",{className:"board-control",children:"Boards allow you to create custom collections of information from your blocks. Use this tool to gather all the info you would need for a session. Select a board to view the blocks within. You can click on a block to expand or minimise it. Click the X button to remove it from that board."})]})}function Ft({user:e}){const t=Be(),[r,o]=d.useState("blocks"),[s,a]=d.useState({title:"Loading",colour:"red"}),[i,l]=d.useState([]),[h,m]=d.useState([]),[g,u]=d.useState([]),[v,S]=d.useState([]),[y,N]=d.useState([]);d.useEffect(()=>{f(),E("Blocks").then(c=>l(c)),E("Folders").then(c=>N(c)),E("Links").then(c=>m(c)),E("Boards").then(c=>u(c)),E("Placements").then(c=>S(c))},[]);const f=d.useCallback(async()=>{try{const c=await Oe(C(j,"Games",t==null?void 0:t.state.gameid)),x={...c.data(),id:c.id};a(x)}catch(c){console.error(c)}}),E=d.useCallback(async c=>{try{return(await Le(M(j,c))).docs.map(B=>({...B.data(),id:B.id})).filter(B=>B.gameid===(t==null?void 0:t.state.gameid))}catch(x){console.error(x)}});return n.jsx(n.Fragment,{children:e?n.jsxs(n.Fragment,{children:[n.jsx(Rt,{selected:r,setSelected:o,game:s}),n.jsx("div",{children:s.title!=="Loading..."&&n.jsxs(n.Fragment,{children:[r==="details"&&n.jsx(Ae,{game:s,setGame:a,details:[i,y,h,g,v]}),r==="blocks"&&n.jsx(Lt,{blocks:i,setBlocks:l,colour:s.colour,setLinks:m,boards:g,gameId:s.id,folders:y,setFolders:N,links:h,setPlacements:S,placements:v}),r==="boards"&&n.jsx(Mt,{boards:g,setBoards:u,placements:v,blocks:i,gameId:s.id,setPlacements:S})]})})]}):n.jsxs("h1",{className:"menu",children:["You must first ",n.jsx(ie,{to:"/login",children:"login"})," to access this page"]})})}export{Ft as default};
